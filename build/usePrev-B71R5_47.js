import{r,dK as p,er as l}from"./strapi-y0akA7lV.js";const d=t=>t&&t.startsWith("/")?`${window.strapi.backendURL}${t}`:t;function m(t,e){const[a,s]=r.useState(t);return r.useEffect(()=>{const n=setTimeout(()=>{s(t)},e);return()=>{clearTimeout(n)}},[t,e]),a}const u=p.injectEndpoints({endpoints:t=>({getRelations:t.query({query:({model:e,id:a,targetField:s,params:n})=>({url:`/content-manager/relations/${e}/${a}/${s}`,method:"GET",config:{params:n}}),serializeQueryArgs:e=>{const{endpointName:a,queryArgs:s}=e;return{endpointName:a,model:s.model,id:s.id,targetField:s.targetField,locale:s.params?.locale,status:s.params?.status}},merge:(e,a)=>{e.pagination&&a.pagination&&(e.pagination.page<a.pagination.page?(e.results=[...o(a.results,e.results),...e.results],e.pagination=a.pagination):a.pagination.page===1&&(e.results=o(a.results),e.pagination=a.pagination))},forceRefetch({currentArg:e,previousArg:a}){return!e?.params&&!a?.params?!1:e?.params?.page!==a?.params?.page||e?.params?.pageSize!==a?.params?.pageSize},transformResponse:e=>"results"in e&&e.results?{...e,results:o(e.results.toReversed())}:e,providesTags:["Relations"]}),searchRelations:t.query({query:({model:e,targetField:a,params:s})=>({url:`/content-manager/relations/${e}/${a}`,method:"GET",config:{params:s}}),serializeQueryArgs:e=>{const{endpointName:a,queryArgs:s}=e;return{endpointName:a,model:s.model,targetField:s.targetField,_q:s.params?._q,idsToOmit:s.params?.idsToOmit,idsToInclude:s.params?.idsToInclude}},merge:(e,a)=>{if(e.pagination&&a.pagination)if(e.pagination.page<a.pagination.page){const s=e.results.map(i=>i.documentId),n=a.results.filter(i=>!s.includes(i.documentId));e.results.push(...n),e.pagination=a.pagination}else a.pagination.page===1&&(e.results=a.results,e.pagination=a.pagination)},forceRefetch({currentArg:e,previousArg:a}){return!e?.params&&!a?.params?!1:e?.params?.page!==a?.params?.page||e?.params?.pageSize!==a?.params?.pageSize},transformResponse:e=>e.results?{...e,results:e.results}:e})})}),o=(t,e=[])=>{const[a]=e.slice(0),s=l(null,a?.__temp_key__??null,t.length);return t.map((n,i)=>({...n,__temp_key__:s[i]}))},{useGetRelationsQuery:f,useLazySearchRelationsQuery:c}=u,y=(t,e)=>{const a=e&&t[e.name]?t[e.name]:null;return typeof a=="string"?a:t.documentId},_=t=>{const e=r.useRef();return r.useEffect(()=>{e.current=t},[t]),e.current};export{f as a,_ as b,c,y as g,d as p,m as u};
