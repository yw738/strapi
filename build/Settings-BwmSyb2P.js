import{u as x,r as I,c as M,P,j as e,d1 as R,cB as y,d2 as F,L as f,bJ as E,bl as L,c6 as B,l as C,h as k,bK as h,bN as r,e7 as T,ct as $,F as H,e8 as N,cC as O,cO as v,cD as D,o as U,a as q,b as z,d as w,co as G}from"./strapi-y0akA7lV.js";import{g as i,u as Q,c as V}from"./getTrad-CDvfXEJb.js";const J=y().shape({restrictedAccess:v(),password:O().when("restrictedAccess",(t,n)=>t?n.required(D.required.id).min(8).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"):n)}),K=U(r.Action)`
  svg {
    height: 1.6rem;
    width: 1.6rem;
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,W=({data:t,onSubmit:n})=>{const{formatMessage:s}=x(),[d,l]=I.useState(!1),{allowedActions:u}=M(P);return e.jsx(R,{enableReinitialize:!0,initialValues:{restrictedAccess:t?.documentationAccess.restrictedAccess||!1,password:""},onSubmit:n,validationSchema:J,children:({handleSubmit:g,values:a,handleChange:p,errors:c,setFieldTouched:m,setFieldValue:o,setFieldError:j,dirty:A})=>e.jsxs(F,{noValidate:!0,onSubmit:g,children:[e.jsx(f.Header,{title:s({id:i("plugin.name"),defaultMessage:"Documentation"}),subtitle:s({id:i("pages.SettingsPage.header.description"),defaultMessage:"Configure the documentation plugin"}),primaryAction:e.jsx(E,{type:"submit",startIcon:e.jsx(L,{}),disabled:!A&&u.canUpdate,children:s({id:i("pages.SettingsPage.Button.save"),defaultMessage:"Save"})})}),e.jsx(f.Content,{children:e.jsx(B,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:e.jsxs(C,{direction:"column",alignItems:"stretch",gap:4,children:[e.jsx(k,{variant:"delta",tag:"h2",children:s({id:"global.settings",defaultMessage:"Settings"})}),e.jsxs(h.Root,{gap:4,children:[e.jsx(h.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:e.jsxs(r.Root,{name:"restrictedAccess",hint:s({id:i("pages.SettingsPage.toggle.hint"),defaultMessage:"Make the documentation endpoint private"}),children:[e.jsx(r.Label,{children:s({id:i("pages.SettingsPage.toggle.label"),defaultMessage:"Restricted Access"})}),e.jsx(T,{checked:a.restrictedAccess,onChange:()=>{a.restrictedAccess===!0&&(o("password","",!1),m("password",!1,!1),j("password",void 0)),o("restrictedAccess",!a.restrictedAccess,!1)},onLabel:"On",offLabel:"Off"}),e.jsx(r.Hint,{})]})}),a.restrictedAccess&&e.jsx(h.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:e.jsxs(r.Root,{name:"password",error:c.password?s({id:c.password,defaultMessage:c.password}):void 0,children:[e.jsx(r.Label,{children:s({id:"global.password",defaultMessage:"Password"})}),e.jsx($,{placeholder:"**********",type:d?"text":"password",value:a.password,onChange:p,endAction:e.jsx(K,{onClick:b=>{b.stopPropagation(),l(S=>!S)},label:s(d?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:d?e.jsx(H,{}):e.jsx(N,{})})}),e.jsx(r.Error,{})]})})]})]})})})]})})},Z=t=>t.name!==void 0,Y=()=>{const{toggleNotification:t}=q(),{formatMessage:n}=x(),{_unstableFormatAPIError:s}=z(),{data:d,isError:l,isLoading:u,isFetching:g}=Q(),[a]=V(),p=async(c,m)=>a({body:c}).unwrap().then(()=>{t({type:"success",message:n({id:i("notification.update.success"),defaultMessage:"Successfully updated settings"})})}).catch(o=>{Z(o)&&o.name==="ValidationError"&&t({type:"danger",message:s(o)})});return u||g?e.jsx(w.Loading,{}):l?e.jsx(w.Error,{}):e.jsx(G,{children:e.jsx(W,{data:d,onSubmit:p})})};export{Y as SettingsPage};
